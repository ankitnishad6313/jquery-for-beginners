<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Task</title>
    <link rel="stylesheet" href="./css/bootstrap.min.css" />
    <style>
      input,
      select {
        border: 1px solid rgb(85, 85, 254) !important;
      }
    </style>
  </head>
  <body>
    <div class="row">
      <h2 class="text-center">Product Form</h2>
    </div>
    <div class="container" id="field-container">
      <div class="row g-4 my-2 fields-row">
        <div class="col-12 col-md-6 col-lg-3">
          <select name="category[]" id="" class="form-select">
            <option value="">Select Category</option>
            <option value="">Pen</option>
            <option value="">Ball</option>
            <option value="">Pencil</option>
            <option value="">Book</option>
          </select>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <select name="subcategory[]" id="" class="form-select">
            <option value="">Select Subcategory</option>
            <option value="">Ball Pen</option>
            <option value="">Natraj</option>
            <option value="">Apsara</option>
            <option value="">Champak</option>
          </select>
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <input
            type="text"
            name="product_name[]"
            id=""
            class="form-control"
            placeholder="Product Name"
          />
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <input
            type="number"
            name="price[]"
            class="form-control price"
            placeholder="Price"
          />
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <input
            type="number"
            name="discount[]"
            id=""
            class="form-control discount"
            placeholder="Discount"
          />
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <input
            type="number"
            name="final_amount[]"
            id=""
            class="form-control final_amount"
            placeholder="Final Amount"
          />
        </div>
        <div class="col-12 col-md-6 col-lg-3">
          <button class="btn btn-outline-primary w-100" id="add-new">
            Add New
          </button>
        </div>
      </div>
    </div>
    <script src="./js/bootstrap.bundle.js"></script>
    <script src="./js/jquery.js"></script>
    <script>
      $(document).ready(function () {
        $("#add-new").click(function () {
          var newFields = $(".fields-row").first().clone();
          newFields.find('select, input').val('');
          newFields.find("#add-new").parent().remove();
          newFields.append(`<div class="col-12 col-md-6 col-lg-3">
                <button class="btn btn-outline-danger w-100 remove-btn">Remove</button>
            </div>`);
          $("#field-container").append(newFields);
        });

        $(document).on('click', '.remove-btn', function(){
          $(this).closest('.fields-row').remove();
        });

        $(document).on('keyup', '.discount', function(){
          var discount = parseFloat($(this).val());
          var price = parseFloat($(this).closest('.fields-row').find('.price').val());
          var final_amount = (price - (price * discount)/100);
          $(this).closest('.fields-row').find('.final_amount').val(final_amount);
        });

      });
    </script>
  </body>
</html>
